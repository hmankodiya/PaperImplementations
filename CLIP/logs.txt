2025-04-28 21:09:27,437 - INFO - train.py - Arguments: {'config': './configs/clip_train_config.yaml', 'just_eval': False}
2025-04-28 21:09:27,441 - DEBUG - utils.py - Attempting to read YAML file from './configs/clip_train_config.yaml'
2025-04-28 21:09:27,448 - INFO - utils.py - YAML file './configs/clip_train_config.yaml' loaded successfully.
2025-04-28 21:09:27,449 - DEBUG - utils.py - Configuration loaded: {'dataset_config': {'desc': 'flicker8k dataset', 'train': {'dataset_path': '/home/hmankodi/Projects/PaperImplementations/CLIP/data/train_dataset.json', 'return_dict': True, 'padding': 'longest', 'image_size': [224, 224], 'max_length': 76, 'sampling_fn': {'sampling_fn_name': 'random_sample'}}, 'val': {'dataset_path': '/home/hmankodi/Projects/PaperImplementations/CLIP/data/test_dataset.json', 'return_dict': True, 'padding': 'longest', 'image_size': [224, 224], 'max_length': 76, 'sampling_fn': {'sampling_fn_name': 'random_sample'}}}, 'tokenizer_config': {'tokenizer_name': 'clip-vit-base-patch32', 'tokenizer_path': 'openai/clip-vit-base-patch32'}, 'model_config': {'clip_model': {'model_name': 'clip-vit-base-patch32', 'model_path': None, 'config': 'default'}}, 'trainer_config': {'save_trained_model': True, 'run_name': 'clip_first_train', 'output_dir': '/home/hmankodi/Projects/PaperImplementations/CLIP/TrainingLogs', 'overwrite_output_dir': True, 'report_to': 'tensorboard', 'logging_steps': 5, 'logging_strategy': 'steps', 'eval_on_start': True, 'do_train': True, 'do_eval': True, 'eval_strategy': 'epoch', 'num_train_epochs': 180, 'per_device_train_batch_size': 1000, 'prediction_loss_only': False, 'save_strategy': 'epoch', 'save_total_limit': 3, 'remove_unused_columns': False, 'save_safetensors': False, 'adam_beta1': 0.9, 'adam_beta2': 0.98, 'adam_epsilon': 1e-06, 'max_grad_norm': 0.3, 'seed': 'random', 'warmup_ratio': 0.05, 'learning_rate': 1e-05, 'lr_scheduler_type': 'cosine', 'optim': 'adamw_torch', 'eval_accumulation_steps': 1, 'resume_from_checkpoint': '/home/hmankodi/Projects/PaperImplementations/CLIP/TrainingLogs/checkpoint-524'}}
2025-04-28 21:09:27,452 - INFO - utils.py - Loaded tokenizer configuration: {'tokenizer_name': 'clip-vit-base-patch32', 'tokenizer_path': 'openai/clip-vit-base-patch32'}
2025-04-28 21:09:27,454 - INFO - model.py - Initializing tokenizer 'clip-vit-base-patch32' with arguments: {'tokenizer_path': 'openai/clip-vit-base-patch32', 'config': {}}
2025-04-28 21:09:27,641 - DEBUG - model.py - CLIP tokenizer loaded successfully.
2025-04-28 21:09:27,648 - INFO - utils.py - Loaded clip model configuration: {'model_name': 'clip-vit-base-patch32', 'model_path': None, 'config': 'default'}
2025-04-28 21:09:27,650 - INFO - model.py - Initializing model 'clip-vit-base-patch32' with arguments: {'model_path': 'openai/clip-vit-base-patch32', 'pretrained': False, 'config': 'default'}
2025-04-28 21:09:29,048 - DEBUG - model.py - Randomly initialized CLIP model created successfully.
2025-04-28 21:09:29,048 - INFO - utils.py - Loaded dataset configuration: {'return_dict': True, 'padding': 'longest', 'image_size': [224, 224], 'max_length': 76}
2025-04-28 21:09:29,061 - INFO - utils.py - Loaded dataset configuration: {'return_dict': True, 'padding': 'longest', 'image_size': [224, 224], 'max_length': 76}
2025-04-28 21:09:29,064 - INFO - utils.py - Loaded trainer configuration: {'save_trained_model': True, 'run_name': 'clip_first_train', 'output_dir': '/home/hmankodi/Projects/PaperImplementations/CLIP/TrainingLogs', 'overwrite_output_dir': True, 'report_to': 'tensorboard', 'logging_steps': 5, 'logging_strategy': 'steps', 'eval_on_start': True, 'do_train': True, 'do_eval': True, 'eval_strategy': 'epoch', 'num_train_epochs': 180, 'per_device_train_batch_size': 1000, 'prediction_loss_only': False, 'save_strategy': 'epoch', 'save_total_limit': 3, 'remove_unused_columns': False, 'save_safetensors': False, 'adam_beta1': 0.9, 'adam_beta2': 0.98, 'adam_epsilon': 1e-06, 'max_grad_norm': 0.3, 'seed': 1636933959, 'warmup_ratio': 0.05, 'learning_rate': 1e-05, 'lr_scheduler_type': 'cosine', 'optim': 'adamw_torch', 'eval_accumulation_steps': 1, 'resume_from_checkpoint': '/home/hmankodi/Projects/PaperImplementations/CLIP/TrainingLogs/checkpoint-524'}
2025-04-28 21:09:29,973 - INFO - train.py - Training started.
 version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
2025-04-28 21:09:29,975 - INFO - train.py - Training started.
